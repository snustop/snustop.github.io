$(function(){$(window).width()<992&&$("#filter-btn-slide").on("click",function(){$("#filters-wrap").stop().slideToggle(300),$("#filter-btn-slide i").toggleClass("rotate-arrow")});var e=$("html, body");$(window).scroll(function(){800<=$(this).scrollTop()?$("#top").fadeIn("fast"):$("#top").fadeOut("fast")}),$("#top").click(function(){e.animate({scrollTop:0},300)});var t=$(".btn-cart"),a=$(".cart");function o(){var e=$("#cart-discount"),t=simpleCart.total(),a=simpleCart.quantity(),o=$("#promo-code").val().toLowerCase(),n=$("#cart-rate");if("5disc"==o){e.text(Math.ceil(.95*t)+" грн");var i=t-Math.ceil(.95*t);n.text("Скидка 5%: "+i+" грн")}else if(10<=a&&"10cans"==o){e.text(Math.ceil(.93*t)+" грн");i=t-Math.ceil(.93*t);n.text("Скидка 7%: "+i+" грн")}else n.text("Скидка 0%: 0 грн");if("burda"==o||"zak"==o||"koval"==o||"kolosov"==o||"kochergin"==o||"nechaev"==o||"past"==o||"dvorak"==o||"black"==o||"ira"==o||"днепр"==o||"заря"==o||"шахта"==o||"динамо"==o||"zah"==o){e.text(Math.ceil(.9*t)+" грн");i=t-Math.ceil(.9*t);n.text("Скидка 10%: "+i+" грн")}}t.on("click",function(){a.addClass("cart-move"),a.one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(e){a.removeClass("cart-move")})}),$("#discount-btn").on("click",function(){o()}),$(".popup-gallery").magnificPopup({delegate:"a",type:"image",tLoading:"Loading image #%curr%...",mainClass:"mfp-img-mobile",fixedContentPos:!1,gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.',titleSrc:function(e){return e.el.attr("title")+'<small>by Instagram <a href="//www.instagram.com/snustop.com.ua/" target="_blank" title="instagram"><i class="icon-instagram"></i>snustop.com.ua</a></small>'}}}),$(".link-reviews").click(function(){return $("html, body").stop().animate({scrollTop:$($(this).attr("href")).offset().top-75},400),!1});var n,i,l,c,r,s,d,m=$("#contact-form");function p(){1==$("#checkout").length&&o(),simpleCart.ready(function(){$(".del").remove(),simpleCart.each(function(e,t){m.append('<input class="del" type="hidden" name="'+e.get("id")+' Название" value="'+e.get("name")+'">'),m.append('<input class="del" type="hidden" name="'+e.get("id")+' Количество" value="'+e.get("quantity")+'">'),m.append('<input class="del" type="hidden" name="'+e.get("id")+' Цена за еденицу" value="'+e.get("price")+'">'),m.append('<input class="del" type="hidden" name="'+e.get("id")+' Общая стоимость" value="'+e.get("total")+'">')})})}p(),simpleCart.bind("update",function(){p()}),m.submit(function(e){e.preventDefault(),$("#send-order").html('Ждите...<i class="loading"></i>'),n=$("#phone").val(),i=$("#message").val(),l=$("#promo-code").val(),c=$("#form-total").text(),localStorage.setItem("phone",n),localStorage.setItem("message",i),localStorage.setItem("coupon",l),$.ajax({url:"https://formspree.io/snustop.com.ua@gmail.com",method:"POST",data:m.serialize()+"&coupon= "+l+"&Итого= "+c,dataType:"json"}).done(function(){simpleCart.empty(),$("#checkout").html('<div class="text-center"><h1>Спасибо за заказ</h1><p>Ожидайте, мы с Вами свяжемся в течение часа.<br><span class="text-muted">Если по каким-то причинам мы не связались, что бывает крайне редко, то свяжитесь с нами сами: <a href="tel:+380675680230" title="Позвонить">+38 067 568 02 30</a></p><p><a href="/">Перейти на главную</a></span></p></div>')}).fail(function(){alert("Ошибка, оформите заказ связавшись с нами: +380675680230")})}),null!==localStorage.getItem("phone")&&(r=localStorage.getItem("phone"),s=localStorage.getItem("message"),d=localStorage.getItem("coupon"),$("#phone").val(r),$("#message").val(s),$("#promo-code").val(d),$("#discount-btn").click()),document.addEventListener("copy",function(){var e=window.getSelection(),t=e+"<br /><br /> Подробнее: "+document.location.href,a=document.createElement("div");a.style.position="absolute",a.style.left="-99999px",document.body.appendChild(a),a.innerHTML=t,e.selectAllChildren(a),window.setTimeout(function(){document.body.removeChild(a)},100)})});
